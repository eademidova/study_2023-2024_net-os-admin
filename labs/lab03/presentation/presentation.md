---
## Front matter
lang: ru-RU
title: Лабораторная работа №3
subtitle: Настройка DHCP-сервера
author:
  - Демидова Е. А.
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 12 ноября 2023 

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
---

# Вводная часть

## Цель работы

Приобретение практических навыков по установке и конфигурированию DHCP-сервера.

## Задание

1. Установите на виртуальной машине server DHCP-сервер.
2. Настройте виртуальную машину server в качестве DHCP-сервера для виртуальной внутренней сети.
3. Проверьте корректность работы DHCP-сервера в виртуальной внутренней сети путём запуска виртуальной машины client и применения соответствующих утилит диагностики.
4. Настройте обновление DNS-зоны при появлении в виртуальной внутренней сети новых узлов.
5. Проверьте корректность работы DHCP-сервера и обновления DNS-зоны в виртуальной
внутренней сети путём запуска виртуальной машины client и применения соответствующих утилит диагностики.
6. Напишите скрипт для Vagrant, фиксирующий действия по установке и настройке DHCP-сервера во внутреннем окружении виртуальной машины server. Соответствующим Ыобразом внести изменения в Vagrantfile.

# Выполнение лабораторной работы

## Установка DHCP-сервера

![Установка dhcp на виртуальной машине server](image/1.png){#fig:001 width=70%}

## Конфигурирование DHCP-сервера

![Копирование и переименования файла примера конфигурации DHCP](image/2.png){#fig:002 width=70%}

## Конфигурирование DHCP-сервера

![Редактирование файла /etc/dhcp/dhcpd.conf](image/3.png){#fig:003 width=60%}

## Конфигурирование DHCP-сервера

![Изменение файла /etc/systemd/system/dhcpd.service](image/4.png){#fig:004 width=60%}

## Конфигурирование DHCP-сервера

![Перезагрузка конфигурации dhcpd и разрешение загрузки DHCP-сервера при запуске виртуальной машины server](image/5.png){#fig:005 width=70%}

## Конфигурирование DHCP-сервера

![Изменение файла прямой зоны](image/6.png){#fig:006 width=60%}

## Конфигурирование DHCP-сервера

![Изменение файла обратной зоны](image/7.png){#fig:007 width=60%}

## Конфигурирование DHCP-сервера

![Обращение к к DHCP-серверу по имени](image/8.png){#fig:008 width=60%}

## Конфигурирование DHCP-сервера

![Разрешение межсетевому экрану работы с DHCP и восстановление контекста безопасности SELinux](image/9.png){#fig:009 width=55%}

## Конфигурирование DHCP-сервера

![Запуск мониторинга происходящих в системе процессов](image/10.png){#fig:010 width=70%}

## Конфигурирование DHCP-сервера

![Запуск DHCP-сервера](image/11.png){#fig:011 width=70%}

## Анализ работы DHCP-сервера

```
cd /var/tmp/user_name/vagrant/provision/client
touch 01-routing.sh
chmod +x 01-routing.sh
```

## Анализ работы DHCP-сервера

![Содержимое файла 01-routing.sh](image/12.png){#fig:012 width=70%}

## Анализ работы DHCP-сервера

![Подключение скрипта в Vagrantfile](image/13.png){#fig:013 width=70%}

## Анализ работы DHCP-сервера

```
make client-provision
```

## Анализ работы DHCP-сервера

![Подключение к виртуальной внутренней сети узла client и выдача ему IP-адреса](image/14.png){#fig:014 width=50%}

Также информацию о работе DHCP-сервера можно наблюдать в файле /var/lib/dhcpd/dhcpd.leases.

## Анализ работы DHCP-сервера

![Информация об интерфейсах виртуальной машины client](image/15.png){#fig:015 width=60%}

## Настройка обновления DNS-зоны

![Разрешение обновления зоны с локального адреса](image/16.png){#fig:016 width=50%}

## Настройка обновления DNS-зоны

Затем перезапустим  DNS-сервер командой:

```
systemctl restart named
```
## Настройка обновления DNS-зоны

![Добавление разрешения на динамическое обновление DNS-записей с локального узла прямой и обратной зон](image/17.png){#fig:017 width=50%}

## Настройка обновления DNS-зоны

![Перезапуск сервера и отображение файла eademidova.net.jnl](image/18.png){#fig:018 width=70%}

## Анализ работы DHCP-сервера после настройки обновления DNS-зоны

С помощью утилиты dig убедимся в наличии DNS-записи о клиенте в прямой DNS-зоне:

```
dig @192.168.1.1 client.eademidova.net
```

## Внесение изменений в настройки внутреннего окружения виртуальной машины

![Создание в каталоге dns /vagrant/provision/server/ конфигурационных файлов](image/19.png){#fig:019 width=70%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

Запишем в dhcp.sh следующий скрипт:

![Изменение файла dhcp.sh](image/20.png){#fig:020 width=70%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

![Изменение файла Vagrantfile](image/21.png){#fig:021 width=50%}

# Заключение

## Выводы

В результате выполнения данной работы были приобретены практические навыки по установке и конфигурированию DHCP-сервера.